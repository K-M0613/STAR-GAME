<h2 style="color: #99CCCC; text-align: center;">投稿一覧</h2>
<div class="container">
  <div class="row">
    <%= form_tag posts_path, method: :get, class: 'boards_searchForm' do %>
      <%= select_tag :tag_id,options_from_collection_for_select(Tag.all, :id, :name, params[:tag_id]),
                     {
                       prompt: 'タグで絞り込み検索',
                       onchange:'submit(this.form);'
                     }
      %>
      <% end %>
      <%= form_with url: search_posts_path, local: true, method: :get, class: 'pl-3' do |f| %>
        <%= f.text_field :keyword %>
        <%= f.submit "検索" %>
      <% end %>
      <p class="pl-3">
        <%= link_to "新しい順", posts_path(latest: "true") %>
        |<%= link_to "古い順", posts_path(old: "true") %>
        |<%= link_to "評価の高い順", posts_path(star_count: "true") %>
      </p>
    <table class="table">
      <thead>
        <tr>
          <th></th>
          <th>投稿者</th>
          <th>商品名</th>
          <th>評価</th>
          <th>タグ</th>
        </tr>
      </thead>
      <tbody>
        <% @posts.each do |post| %>
        <tr>
          <td><%= image_tag post.user.get_profile_image, size:'50x50' %></td>
          <td>
            <%= link_to my_page_path(post.user_id) do %>
              <%= post.user.nickname %>
            <% end %>
          </td>
          <td>
            <%= link_to post_path(post) do %>
              <%= post.title %>
            <% end %>
          </td>
          <td>
            <div id="star-rate<%= post.id %>"></div>
            <script>
              $('#star-rate<%= post.id %>').empty();
              $('#star-rate<%= post.id %>').raty({
                size :36,
                starOff: '<%= asset_path('star-off.png') %>',
                starOn : '<%= asset_path('star-on.png') %>',
                starHalf: '<%= asset_path('star-half.png') %>',
                half: true,
                readOnly: true,
                score: <%= post.star %>
              })
            </script>
          </td>
          <td>
            <% post.tags.each do |tag| %>
              <span><%= tag.name %></span>
            <% end %>
          </td>
          <td id="book_mark_buttons_<%= post.id %>">
            <%= render "public/book_marks/bookmark", post: post %>
          </td>
        </tr>
       <% end %>
      </tbody>
    </table>
  </div>
  <%= paginate @posts %>
</div>

